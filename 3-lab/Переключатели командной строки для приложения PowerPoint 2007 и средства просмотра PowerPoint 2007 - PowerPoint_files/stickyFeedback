(function(n){"use strict";(function(){function u(i){if(typeof MscomCustomEvent!="undefined"){var u=["ms.pgarea","Body","ms.cmpgrp","FeedbackControl","ms.ea_offer",r===t.search?"serp":"article","ms.svi","1"];r===t.search&&(u.push("ms.searchquery"),u.push(occe.searchQuery),u.push("ms.searchscope"),u.push(occe.appSearchFilter),u.push("ms.searchpg"),u.push(occe.pageParam));!i||n.each(i,function(n,t){u.push(n);u.push(t)});MscomCustomEvent.apply(window,u)}}function o(){n("#ocSmartFeedbackBegin").remove();n("#ocSmartFeedbackReply").removeClass("ocHidden");n("#ocHelp").css("padding-bottom",n("#ocFooterWrapper").height()+"px");n("#supWrapperToPreventFeedbackFlickering").addClass("supFeedbackFullTextIsOpen")}function i(t){n("#ocFeedbackFinalThankYouMessage").removeClass("ocHidden");n("#supWrapperToPreventFeedbackFlickering").removeClass("supFeedbackFullTextIsOpen");n("#ocHelp").css("padding-bottom",n("#ocFooterWrapper").height()+"px");t||s()}function s(){setTimeout(function(){n("#supFeedbackWrapper").hide()},3e3)}var t={f1:"f1",article:"article",search:"search"},e=n("#smartFeedbackForm"),r="",f;n.each(window.location.pathname.split("/"),function(n,i){return i=i.toLowerCase(),i===t.f1||i===t.article||i===t.search?(r=i,!1):void 0});n("#ocButtonSendNoComment").removeClass("ocHidden");f=!1;n("#smartFeedbackForm").on("click","button[name=feedbackSelection]",function(){var t={"ms.interactiontype":occe.constants.wedcs.interactionType.completedFinalStepInSeries,"ms.ea_action":"FeedbackControlRate","ms.svq":"1","wcs.cot":"1","wcs.et":"2","wcs.cn":n(this)[0].innerText||""},i;n(this).attr("id")==="buttonYes"?(n("#ocFeedbackHeaderIfArticleHelpful").removeClass("ocHidden"),t["ms.sva"]="100"):(n("#ocFeedbackHeaderIfArticleNotHelpful").removeClass("ocHidden"),t["ms.sva"]="0",f=!0);occe.Controls.TabControlModule&&(i=occe.Controls.TabControlModule.collectTabControlCustomWedcsData(),t["ms.activetab"]=i["ms.activetab"],t["ms.defaulttab"]=i["ms.defaulttab"],t["ms.tabTargetingActivated"]=i["ms.tabTargetingActivated"]);u(t);o();n("#feedbackText").focus()}).submit(function(o){var s,h,c;o.preventDefault();e.addClass("ocHidden");s=n("#feedbackText").val();h={"ms.interactiontype":occe.constants.wedcs.interactionType.formSubmit,"ms.ea_action":"Comment","ms.svq":"2","ms.svv":s};n("#smartFeedbackForm").data("sentiment-analysis")?(c=n("#smartFeedbackForm input[name=__RequestVerificationToken]").val(),i(!0),n.ajax({type:"post",url:window.location.protocol+"//"+window.location.host+"/f1/sentimentService",data:{query:s,__RequestVerificationToken:c},success:function(e){h["ms.sentimentScore"]=e.Score||"unknown";u(h);OOGlobal&&OOGlobal.Culture&&OOGlobal.Culture.toLowerCase()==="en-us"&&(r===t.f1||r===t.article)&&f&&e.RedirectToSupport&&n("#smartFeedbackForm").data("support-available")?n.ajax({url:"/home/chatLink",type:"POST",data:{issueDescription:s,__RequestVerificationToken:c},success:function(t){t.chatLink?(n("#smartFeedbackChatLink").attr("href","/home/chat?"+n.param({isFromFeedback:!0,query:s})),n("#ocFeedbackFinalThankYouMessage").addClass("ocHidden"),n("#ocFeedbackToChat").removeClass("ocHidden")):i()}}):i()},error:function(){i();u(h)}})):(i(),u(h))});n("#ocButtonSendNoComment").click(function(){e.addClass("ocHidden");i();u({"ms.interactiontype":occe.constants.wedcs.interactionType.formSubmit,"ms.ea_action":"Comment","ms.svq":"2","ms.svv":""})})})()})(jQuery),function(n){"use strict";n(function(){occe.Controls=occe.Controls||{};occe.Controls.Feedback=function(){function d(){h=n("#footerArea");r=n("#ocArticle");c=n("#supFeedbackWrapper");u=n("#supDisableStickyFeedbackButton");g();u.click(function(){occe.SetCookie(p,"true");e=!0;a()});f.on("scroll resize",function(){t=y();o=b();i=s();v()});r.click(function(){i=s();v()})}function g(){e=w();o=b();l=nt();t=y();i=s()}function w(){return occe.GetCookie(p)==="true"}function b(){return occe.windowIsTabletSizeOrSmaller()}function nt(){return h.offset().top-n(window).height()<=200}function a(){c.removeClass("supStickyFeedback");u.addClass("ocHidden")}function v(){var n=!i&&!e&&!o&&t&&!l;n?k():a()}function s(){return f.scrollTop()+f.height()>h.offset().top}function k(){c.addClass("supStickyFeedback");u.removeClass("ocHidden")}function y(){if(t)return!0;var n=f.scrollTop(),i=r.offset().top,u=r.height()/4;return n>i+u}var h,r="hello",c,u,f=n(window),p="userHasDisabledFeedbackStickiness",e,o,l,t,i;return{initializeControl:d,attachFeedbackAboveUniversalFooter:a,makeFeedbackSticky:k,hasUserDisabledFeedbackStickiness:w,hasUserSeenOneFourthOfArticle:y,updateFeedbackStickiness:v,isUniversalFooterVisible:s,setUserHasDisabledFeedbackStickiness:function(n){e=n},setUniversalFooterInViewport:function(n){i=n},setWindowTooTightForStickiness:function(n){o=n},setArticleTooShortForStickiness:function(n){l=n},setUserHasSeenOneFourthOfArticle:function(n){t=n}}}()})}(jQuery),function(n){"use strict";n(function(){occe.Controls.Feedback.initializeControl()})}(jQuery)