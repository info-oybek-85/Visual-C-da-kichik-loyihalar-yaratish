var awa={},behaviorKey;awa.isInitialized=!1;awa.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3};awa.behavior={UNDEFINED:0,NAVIGATIONBACK:1,NAVIGATION:2,NAVIGATIONFORWARD:3,APPLY:4,REMOVE:5,SORT:6,EXPAND:7,REDUCE:8,CONTEXTMENU:9,STARTPROCESS:20,PROCESSCHECKPOINT:21,COMPLETEPROCESS:22,DOWNLOADCOMMIT:40,DOWNLOAD:41,SEARCHAUTOCOMPLETE:60,SEARCH:61,PURCHASE:80,ADDTOCART:81,VIEWCART:82,ADDWISHLIST:83,FINDSTORE:84,CHECKOUT:85,SIGNIN:100,SIGNOUT:101,SOCIALSHARE:120,SOCIALLIKE:121,SOCIALREPLY:122,VOTE:140,SURVEYINITIATE:141,SURVEYCOMPLETE:142,REPORTAPPLICATION:143,REPORTREVIEW:144,CONTACT:160,REGISTRATIONINITIATE:161,REGISTRATIONCOMPLETE:162,CHATINITIATE:180,CHATEND:181,TRIALSIGNUP:200,TRIALINITIATE:201,PARTNERREFERRAL:220,VIDEOSTART:240,VIDEOPAUSE:241,VIDEOCONTINUE:242,VIDEOCHECKPOINT:243,VIDEOJUMP:244,VIDEOCOMPLETE:245,VIDEOBUFFERING:246,VIDEOERROR:247,VIDEOMUTE:248,VIDEOUNMUTE:249,VIDEOFULLSCREEN:250,VIDEOUNFULLSCREEN:251,VIDEOREPLAY:252,VIDEPLAYERLOAD:253,VIRTUALEVENTJOIN:260,VIRTUALEVENTEND:261,IMPRESSION:280,CLICK:281,RICHMEDIACOMPLETE:282,ADBUFFERING:283,ADERROR:284,ADSTART:285,ADCOMPLETE:286,ADSKIP:287,ADTIMEOUT:288,OTHER:300};awa.behaviorKeys=[];for(behaviorKey in awa.behavior)awa.behaviorKeys.push(behaviorKey);awa.actionType={CLICKLEFT:"CL",CLICKRIGHT:"CR",SCROLL:"S",ZOOM:"Z",RESIZE:"R",KEYBOARDENTER:"KE",KEYBOARDSPACE:"KS",OTHER:"O"};awa.cookie=function(){function r(t,i){var e=n(t),f,r,u;if(e&&i)for(f=e.split("&"),r=0;r<f.length;r++)if(u=f[r].split("="),u[0]&&i.toLowerCase()===u[0].toLowerCase())return u[1];return null}function n(n){for(var i,r,f,e=document.cookie.split(";"),u=0;u<e.length;u++){for(i=e[u];i.charAt(0)==" ";)i=i.substring(1);if(r=i.split("="),f=t(r.shift()),f===n)return t(r.join("="))}return null}function t(n){var t=decodeURIComponent(n.replace("/+/g"," "));return t.indexOf('"')===0&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}function i(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString()):u="";window.document.cookie=n+"="+t+u+"; path=/;"}function u(n){i(n,"",-1)}return{getCookie:n,getCookieKeyValue:r,setCookie:i,deleteCookie:u}}();awa.cv=function(){function y(){return u(r())}function r(){return f.concat(".",i)}function h(){var n=r();if(u(n))return n}function p(i){var r,f,e,o,s;if(u(i)){for(r=i.split("."),f=r.length,r[f-1]=parseInt(r[f-1],10)+1,e="",o=0;o<f;o++)e+=r[o],o<f-1&&(e+=".");if(s=r[0].length==n.baseLength?n.maxCorrelationVectorLength:t.maxCorrelationVectorLength,e.length<=s)return e}}function c(){var n=r();return u(n)?v(n.length+2):!1}function l(){return u(r())?v(f.length+1+(i+1+"").length):!1}function a(n){if(u(n)){var t=n.lastIndexOf(".");f=n.substr(0,t);i=parseInt(n.substr(t+1),10)}else return awa.logger.logWarning("Cannot set invalid correlation vector value"),null;return r()}function w(n){return n?a(n):(f=b(),i=0,h())}function b(){for(var n="",t=0;t<o.baseLength;t++)n+=e.charAt(Math.floor(Math.random()*e.length));return n}function k(){if(c())return f=f.concat(".",i),i=0,r()}function d(){if(l())return i=i+1,r()}function u(n){if(n){var t=n.split(".")[0];if(t){if(t.length==16)return s=1,g(n);if(t.length==22)return s=2,nt(n)}}}function g(n){if(t.validationPattern.test(n)&&n.length<=t.maxCorrelationVectorLength)return!0}function nt(t){if(n.validationPattern.test(t)&&t.length<=n.maxCorrelationVectorLength)return!0}function v(i){return s==1?i<=t.maxCorrelationVectorLength:i<=n.maxCorrelationVectorLength}function tt(){o=t}function it(){o=n}var f="",i=0,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={},n,o,s;return t.maxCorrelationVectorLength=63,t.baseLength=16,t.validationPattern=new RegExp("^["+e+"]{"+t.baseLength.toString()+"}(.[0-9]+)+$"),n={},n.maxCorrelationVectorLength=127,n.baseLength=22,n.validationPattern=new RegExp("^["+e+"]{"+n.baseLength.toString()+"}(.[0-9]+)+$"),o=n,s=2,{header:"MS-CV",tag:"cV",isInit:y,canExtend:c,canIncrement:l,getValue:h,setValue:a,init:w,extend:k,increment:d,incrementExternal:p,isValid:u,useCv1:tt,useCv2:it}}();awa.logger=function(){function n(n){awa.consoleVerbosity>=awa.verbosityLevels.ERROR&&console&&console.error&&console.error("JSLL: "+n)}function t(n){awa.consoleVerbosity>=awa.verbosityLevels.WARNING&&console&&console.warn&&console.warn("JSLL: "+n)}function i(n){awa.consoleVerbosity>=awa.verbosityLevels.INFORMATION&&console&&console.log&&console.log("JSLL: "+n)}return{logError:n,logWarning:t,logInformation:i}}();awa.capabilitiesCheck=function(){return function(){if(!JSON||!JSON.stringify)return awa.logger.logError("Unable to write event: the global JSON.stringify method does not exist"),awa.isAvailable=!1,!1}}();awa.utils=function(){function l(n,t){var i,r,u;if(t)try{return(i=JSON.stringify(t),i=="{}"&&n=="timing")?a():i}catch(f){return r='{"error": "ERROR: could not stringify {0} {1}"}',u=typeof t=="string"?t:"",r.replace("{0}",n).replace("{1}",u)}}function a(){for(var u,t=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],f="{",n=0;n<t.length;n++)u=r[t[n]],i(u)&&(f+='"'+t[n]+'":'+u,n<t.length-1&&(f+=","));return f+"}"}function v(n){return{"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"}[n]}function y(n,t){if(n=="string")return typeof t=="string"||t instanceof String||t instanceof Date;if(n=="bool")return typeof t=="boolean"||t instanceof Boolean;if(!(typeof t=="number"||t instanceof Number))return!1;if(n=="uint8"){if(t<0||t>255||t%1!=0)return!1}else if(n=="uint16"){if(t<0||t>65535||t%1!=0)return!1}else if(n=="uint32"){if(t<0||t>4294967295||t%1!=0)return!1}else if(n=="uint64"){if(t<0||t>18446744073709551615||t%1!=0)return!1}else if(n=="int8"){if(t<-128||t>127||t%1!=0)return!1}else if(n=="int16"){if(t<-32768||t>32767||t%1!=0)return!1}else if(n=="int32"){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if(n=="int64"){if(t<-9223372036854775808||t>9223372036854775807||t%1!=0)return!1}else if(n=="float"){if(t<-3402823e32||t>3402823e32)return!1}else if(n=="double"&&(t<-Number.MAX_VALUE||t>Number.MAX_VALUE))return!1;return!0}function p(){if(f===""){var n=o().toLowerCase();f=n.indexOf("windows phone")!=-1?"WindowsPhone":n.indexOf("win")!=-1?"Windows":n.indexOf("mac")!=-1?"MacOS":n.indexOf("x11")!=-1?"Unix":n.indexOf("android")!=-1?"Android":n.indexOf("linux")!=-1?"Linux":n.indexOf("webos")!=-1?"webOS":n.indexOf("blackberry")!=-1?"BlackBerry":n.indexOf("ipod")!=-1||n.indexOf("ipad")!=-1||n.indexOf("iphone")!=-1?"iOS":n.indexOf("symbian")!=-1?"Symbian":n.indexOf("nokia")!=-1?"Nokia":"Unknown"}return f}function w(){e=window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function o(){return e===""&&w(),e}function b(n,t){var i;return n&&n[t]&&(i=n[t],delete n[t]),i}function k(n,i){n=t(n);var r=n.getBoundingClientRect(),u=d(r,i);return u>0?!0:!1}function d(n,t){var i=n.left,r=n.top,u=n.right,f=n.bottom,e=t.left,o=t.top,s=t.right,h=t.bottom,c=Math.max(0,Math.min(u,s)-Math.max(i,e)),l=Math.max(0,Math.min(f,h)-Math.max(r,o));return c*l}function t(n){return typeof jQuery=="function"&&n instanceof jQuery?n[0]:n}function n(n){var t=String(n);return t.length===1&&(t="0"+t),t}function g(t){return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}function nt(){var n;try{n=window.performance.getEntries().filter(function(n){return n.initiatorType==="script"||n.initiatorType==="link"})}catch(t){}return n}function tt(){var n;return r.loadEventStart>0&&(n=r.loadEventStart-r.navigationStart),n}function it(){return document.title.substring(0,150)}function rt(n){return"["+n+"]"}function ut(n,t){return c=t,s(n,et)}function ft(n){return s(n,ot)}function s(n,i){var r=n;if(r){for(r=t(r);!i(r);)if(r=r.parentNode,r=t(r),!r||!r.getAttribute)return null;return r}}function et(n){var t=n.getAttribute(c);return i(t)||t===""}function ot(n){return n.nodeName=="A"}function st(n){var i,t;return n&&(t=n.split(":"),i=t.length>1&&t[0].toLowerCase()=="js"?n:ct+n),i}function u(n){for(var t in n)i(n[t])&&(JSON.stringify(n[t])!="{}"||t=="callback")||delete n[t]}function i(n){return!(n===undefined||n===null||n==="")}function ht(n,t){var r,i;u(n);for(r in t)i=t[r],typeof n[i]=="object"?u(n[i]):delete n[i]}var f="",e="",r=window.performance?window.performance.timing:undefined,ct="JS:",h=function(){var t={},i=!1,n=0,f=arguments.length,r,u;for(Object.prototype.toString.call(arguments[0])==="[object Boolean]"&&(i=arguments[0],n++),r=function(n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=i&&Object.prototype.toString.call(n[r])==="[object Object]"?h(!0,t[r],n[r]):n[r])};n<f;n++)u=arguments[n],r(u);return t},c="";return{stringifyField:l,getMuidHost:v,isOfCorrectType:y,getOs:p,getUserAgent:o,extractFieldFromObject:b,isElementTrulyVisible:k,dateToISOString:g,extend:h,returnDomObjectIfjQuery:t,findClosestByAttribute:ut,findClosestAnchor:ft,getPerformanceData:nt,getPageLoadTime:tt,getTitle:it,removeInvalidElements:u,removeNonObjectsAndInvalidElements:ht,bracketIt:rt,getAppIdWithPrefix:st,isValueAssigned:i}}();awa.ids=function(){function f(){function n(){return Math.floor(Math.random()*16).toString(16)}var t="xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,n);return t.replace("R",(8|Math.floor(Math.random()*3)).toString(16))}function v(){return t.getCookie("MS0")}function y(){return t.getCookie("MUID")}function p(){return r}function w(){return h?r=f():h=!0,r}function e(){return t.getCookie(u)}function b(){var n=t.getCookie("MUID");return n&&n.length?"t:"+n:n}function k(n){if(i=null,n){for(var t=0;t<l.length;t++)if(l[t]==n.substring(0,2)){i=n;break}i||awa.logger.logWarning("Unsupported app user id: "+n+". Supported app user ids are: c:, i:, and w:")}}function d(n){var t,i,r;if(!n||n.length<4)return!1;for(i=!1,r=n.substring(0,3).toString().toUpperCase(),t=0;t<a.length;t++)if(a[t]+":"==r&&n.length<=256){i=!0;break}return i}function o(t){var r,i;if(t){if(t==n)return;for(n=null,r=t.split(","),i=0;i<r.length;i++)d(r[i])?n?n+=","+r[i]:n=r[i]:awa.logger.logWarning("Unsupported flight id format for this app expId: "+r[i])}else{n=null;return}}function s(){return n}function g(n){n&&(c=n)}function nt(){return c}var r=f(),t=awa.cookie,i=null,n=null,h=!1,u="Treatments",c,l=["c:","i:","w:"],a=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];return{getSessionId:v,getVisitorId:y,getMuidUserId:b,setAppUserId:k,getAppUserId:function(){return i},readExpIdFromCookie:function(){return o(e()),s()},readExpIdFromCoreData:function(n){return o(n),s()},getImpressionGuid:p,getPageViewImpressionGuid:w,getGroups:e,setDeviceClass:g,getDeviceClass:nt,setExpIdCookieName:function(n){u=n},getExpIdCookieName:function(){return u}}}();awa.vortexEvents=function(){function e(){n.length>0&&(awa.writeEvent(n),n=[])}function u(){while(n.length>0)awa.writeEvent(n.pop())}function t(t,i){if(i===!0){awa.writeEvent(t);return}if(f){if(f==="complete"){awa.writeEvent(t);return}}else if(document.readyState==="complete"){awa.writeEvent(t);return}(n.length===0||r===0)&&(window.addEventListener?window.addEventListener("load",u):window.attachEvent&&window.attachEvent("onload",u));n.push(t);r>1&&n.length>=r&&e()}function o(n){var i={};n.type==="CorsDisallowed"?i={name:"Ms.Cll.Javascript.CorsDisallowed",data:{"Ms.Cll.Javascript.CorsDisallowed":{eventName:n.eventName}}}:n.type==="EventTooLong"&&(i={name:"Ms.Cll.Javascript.EventTooLong",data:{"Ms.Cll.Javascript.EventTooLong":{eventName:n.eventName,payloadLength:n.payloadLength}}});t(i)}function s(n,r){var u={name:"Ms.Webi.ClientError",data:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(n),wasDisplayed:r||!1,customSessionGuid:i.getSessionId(),impressionGuid:i.getImpressionGuid()}}};t(u)}function h(n){var r={name:"Ms.Webi.OutgoingRequest",cV:n.cV,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:n.currentOperationName,targetUri:n.requestUri,latencyMs:n.latencyMs,serviceErrorCode:n.serviceErrorCode||-1,succeeded:n.isSuccess,requestMethod:n.httpMethod,responseContentType:n.contentType,protocolStatusCode:n.httpStatusCode,dependencyOperationName:n.operationName,dependencyOperationVersion:n.operationVersion,dependencyName:n.serviceName,dependencyType:n.serviceType||"WebService",responseSizeBytes:n.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:i.getSessionId(),impressionGuid:i.getImpressionGuid(),message:n.errorMessage,retryCount:n.retryCount,customData:n.customData}}};t(r)}var i=awa.ids,n=[],f=null,r=0;return{sendError:s,sendApiComplete:h,sendJsllEvent:o,SendOrScheduleEvent:t,batchQueuedEvents:e,drainQueuedEvents:u,batchEventsByNumber:function(n){r=n},overrideQueueBehavior:function(n){n&&n.domReadyState&&(f=n.domReadyState)}}}();awa.errorHandler=function(){function n(n){var t=window.onerror;window.onerror=function(){t&&t.apply(this,arguments);n.apply(this,arguments)}}function t(n){return n.stack?n.stack.substring(0,1e3):""}function i(){if(arguments){var n={Page:window.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,StackTrace:arguments[4]?t(arguments[4]):"",UserAgent:awa.utils.getUserAgent()||"",Platform:window.navigator.platform||""};u.sendError(n,!1)}}function r(){n(i)}var u=awa.vortexEvents;return{init:r}}();awa.timespanHandler=function(){function t(t,i){var r=(new Date).getTime();if(i)return r-n[t];n[t]=r}var n={};return{recordTimeSpan:t}}(),function(){function h(t){var f,o,r,u;for(i="",f=0;f<t.length;f++)f>0&&(i+="\n"),i+=JSON.stringify(t[f]);o="";awa.OnSuccessfulVortexRequest&&(o=n.endpoint+"/t.req?"+i);v==="xhr"?(r=new XMLHttpRequest,r.open("POST",encodeURI(n.endpoint),!0),r.withCredentials=!0,r.onload=function(){r.status===200?e(o):d(r.statusText,r.status)},r.onerror=function(){d(r.statusText,r.status)},r.send(i)):v==="XDomainRequest"?(u=new XDomainRequest,u.onload=function(){e(o)},u.onerror=function(){ht(u)},u.open("POST",n.endpoint),u.send(i)):awa.logger.logError("No event is sent.")}function nt(t){var r,u;for(i="",r=0;r<t.length;r++)r>0&&(i+="\n"),i+=JSON.stringify(t[r]);u="";awa.OnSuccessfulVortexRequest&&(u=n.endpoint+"/t.bcn?"+i);navigator.sendBeacon(n.endpoint,i)?e(u):h(t)}function y(){return n.callback&&typeof n.callback.signedinStatus=="function"?n.callback.signedinStatus():n.isLoggedIn}function tt(n){var t=document.createElement("iframe"),i;t.id="telframe";t.style.display="none";i=function(n){it();e(n)};t.attachEvent?t.attachEvent("onload",function(){i(n)}):t.onload=function(){i(n)};t.src=n;k=!0;document.body.appendChild(t)}function it(){if(document.cookie.indexOf("Bounced")==-1){var t=document.head||document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.src=n.endpoint.replace("collect/v1","awa/bounced.js");t.insertBefore(i,t.firstChild)}}function rt(){var n=t.getUserAgent(),i=n.indexOf("MSIE ");return i>0?parseInt(n.substring(i+5,n.indexOf(".",i)),10)<9:!1}var c,l,o,a;awa._schemas=awa._schemas||[];var t=awa.utils,f=t.isValueAssigned,n={endpoint:"https://web.vortex.data.microsoft.com/collect/v1",sendMode:1,batchSize:10,logLevel:awa.verbosityLevels.NONE,syncMuid:!0,useDefaultContentName:!0,useShortNameForContentBlob:!1,debounceMs:{scroll:600,resize:3e3},muidDomain:"microsoft.com",biBlobAttributeTag:"data-m",isLoggedIn:!1,shareAuthStatus:!1,cookiesToCollect:["MSFPC","ANON"],useBeacon:!0,autoCapture:{pageView:!0,onLoad:!0,click:!0,scroll:!1,resize:!1,jsError:!0,addin:!0,perf:!0,assets:!1},callback:{pageName:null,pageActionPageTags:null,pageViewPageTags:null,contentUpdatePageTags:null,pageActionContentTags:null,signedinStatus:null},coreData:{referrerUri:document.referrer,requestUri:"",appId:window.location.hostname,pageName:"",pageType:"",env:"",product:"",market:"",serverImpressionGuid:"",expId:"",pageTags:{}}},p=[];for(c in n)typeof n[c]=="object"&&p.push(c);var ut="2.1",w="4.0.2",b="1.1",ft=rt(),et=ft?2083:15e3,r="",k=!1,i="",s=!1,ot=f(navigator)&&f(navigator.sendBeacon);awa.experimentIdTag="expId";awa.isAvailable=!0;awa.getRequestBody=function(){return i};awa.getQueryStringParameters=function(){return r};Object.freeze&&Object.freeze(awa.verbosityLevels);awa.capabilitiesCheck();var v=window.XDomainRequest?"XDomainRequest":"xhr",st=function(){return v=="XDomainRequest"&&n.endpoint&&n.endpoint.indexOf(window.location.protocol)!==0?(awa.logger.logError("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1):!0},d=function(n,t){awa.logger.logError("Failure sending data to vortex: "+n+"Error: "+t)},e=function(t){awa.OnSuccessfulVortexRequest&&awa.OnSuccessfulVortexRequest(t);n.sendMode==1&&s===!1&&(s=!0,ct());awa.logger.logInformation("Success sending data to vortex")},ht=function(n){awa.logger.logError("Failure sending data to vortex using XDomainRequest.  Status code:"+n.status)},ct=function(){awa.vortexEvents.overrideQueueBehavior({domReadyState:"complete"});awa.vortexEvents.drainQueuedEvents()},u=function(n,t,i){if(f(t)&&(i||t.length!==0)){var u=i?"":"'";r.length>0&&(r+="&");r+=n+"="+u+encodeURIComponent(t)+u}},g=function(n,i,r,e){for(var o,s,v,c,y,h,p,w,b,l,d=e=="C"?"*":"-",a=i.fields,k=0;k<a.length;k++){if(o=a[k],s=r[o.name],!f(s)){if(o.req)return awa.logger.logError("Missing required property: "+o.name),!1;continue}if(u(d+o.name,s,o.type!="string"),o.type=="map"){v={};for(c in s){if(!t.isOfCorrectType(o.key,c))return awa.logger.logError("A key in the map was of the wrong type: "+o.name),!1;if(!t.isOfCorrectType(o.element,s[c]))return awa.logger.logError("A value in the map was of the wrong type: "+o.name),!1;v[c]=s[c]}n[o.name]=v}else if(o.type=="list"||o.type=="set"){if(y=[],Object.prototype.toString.call(s)==="[object Array]")for(h=0;h<s.length;h++){if(f(s[h])&&!t.isOfCorrectType(o.element,s[h]))return awa.logger.logError("The list contains a value of the wrong type: "+o.name),!1;y[h]=s[h]}else return awa.logger.logError("The "+o.type+" "+o.name+" was not an array as expected"),!1;n[o.name]=y}else if(o.type=="struct"){if(p={},!g(p,o.def,s,e))return!1;n[o.name]=p}else{if(!t.isOfCorrectType(o.type,s))return awa.logger.logError("Property is the wrong type: "+o.name),!1;n[o.name]=s}}for(w in r){for(b=!1,l=0;l<a.length;l++)if(a[l].name==w){b=!0;break}b||awa.logger.logWarning("An unexpected field was found in  the event content and dropped: "+w)}return!0};for(awa.init=function(i){if(!awa.isInitialized){awa.isInitialized=!0;i&&(t.removeNonObjectsAndInvalidElements(i,p),n=t.extend(!0,n,i));var r=n.sendMode;r==0&&(s=!0);r>=1&&awa.vortexEvents.overrideQueueBehavior({domReadyState:"notComplete"});r==2&&awa.vortexEvents.batchEventsByNumber(n.batchSize);awa.consoleVerbosity=n.logLevel;awa.ct.initialize(n)}},awa.writeEvent=function(t){var f=!0,u=[],c,a,v,p,i,l,b,w,o;if(Object.prototype.toString.call(t)==="[object Array]")for(f=!1,c=0;c<t.length;c++)a=awa._validateAndTranslateEvent(t[c]),a.success&&u.push(a.event);else v=awa._validateAndTranslateEvent(t),v.success&&u.push(v.event);if(u.length!==0){if(f&&r&&(p=n.endpoint.length+r.length,p+7>et&&(awa.logger.logWarning("event is too large to send using get -- using post instead"),i={},i.eventName=t.name,i.payloadLength=p,i.type="EventTooLong",awa.vortexEvents.sendJsllEvent(i),f=!1)),!f&&!st()){i={};i.eventName=t.name;i.type="CorsDisallowed";awa.vortexEvents.sendJsllEvent(i);return}f&&r?n.shareAuthStatus===!0&&y()===!0&&document.cookie.indexOf("Bounced=")==-1&&k===!1?(l=n.authMethod==1?"/asm.html":"/asa.html",b=n.endpoint+l+"?"+r,tt(b)):ot&&n.useBeacon===!0&&s===!0&&n.shareAuthStatus===!1?nt(u):(l=n.shareAuthStatus===!0&&y()===!0?n.authMethod==1?"/asm.gif":"/asa.gif":"/t.gif",w=n.endpoint+l+"?"+r,o=new Image,o.onload=function(){o.width==1&&e(w)},o.onerror=function(){awa.logger.logWarning("Telemetry image beacon not sent properly. Sending through POST.");h(u)},o.src=w):h(u)}},awa._validateAndTranslateEvent=function(i){function e(n,t,i){y[n]=t;u(n,t,i)}var y={},c={},nt={},o={event:y,success:!1},ot,p,s,tt,it,rt,k,l,d,a,v,ft;if(r="",!i)return awa.logger.logError("Unable to write null event"),o;if(!i.name)return awa.logger.logError("Unable to write event with missing name"),o;if(!awa._schemas.hasOwnProperty(i.name))return awa.logger.logError("Unable to write event: a schema for the event named {"+i.name+"} does not exist"),o;if(!i.data)return awa.logger.logError("Unable to write event: the event is missing content"),o;e("ver",ut);e("name",i.name);e("time",t.dateToISOString(new Date));e("os",t.getOs());e("deviceClass",awa.ids.getDeviceClass());ot=i.appId?i.appId:n.coreData.appId;e("appId",t.getAppIdWithPrefix(ot));i.isSensitive=="true"&&e("flags",524288,!0);p=awa._schemas[i.name];for(s in p)if(s!=="name"){if(tt=p[s],!i.data.hasOwnProperty(s))return awa.logger.logError("Unable to write event: missing expected part: "+s),o;if(tt.part=="C"?it=nt:(it={},nt.baseData=it,nt.baseType=s,u("*baseType",s)),!g(it,tt.def,i.data[s],tt.part))return o}for(rt in i.data)p[rt]&&p[rt].part||awa.logger.logWarning("An unexpected property was found in the event content and dropped: "+rt);y.data=nt;y.tags={};i.hasOwnProperty(awa.cv.tag)?e(awa.cv.tag,i.cV):awa.cv.isInit()&&e(awa.cv.tag,awa.cv.getValue());var h={},st="env",ht=i.env,et=f(ht)?ht:n.coreData.env;return f(et)&&(h[st]=et,c.app=h,u("ext-app-"+st,et)),k=n&&n.coreData&&n.coreData.expId?awa.ids.readExpIdFromCoreData(n.coreData.expId):awa.ids.readExpIdFromCookie(),k&&(t.isOfCorrectType("string",k)?(h[awa.experimentIdTag]=k,c.app=h,u("ext-app-"+awa.experimentIdTag,k)):awa.logger.logError("The supplied experiment id is invalid: "+i[awa.experimentIdTag]+"Continuing to process event without this value.")),l=awa.ids.getAppUserId(),l&&(t.isOfCorrectType("string",l)?(h={},h.userId=l,c.app=h,u("ext-app-userId",l)):awa.logger.logError("ignoring the app userId value because it is invalid: "+l)),d={},a=window.location.hostname,f(a)||(a=window.location.protocol=="file:"?"local":a),d.ver=b,d.libVer=w,d.domain=a,c.javascript=d,u("ext-javascript-ver",b),u("ext-javascript-libVer",w),u("ext-javascript-domain",a),v=awa.ids.getMuidUserId(),v&&(t.isOfCorrectType("string",v)?(ft={},ft.localId=v,c.user=ft,u("ext-user-localId",v)):awa.logger.logError("ignoring the userid value because it is invalid: "+v)),y.ext=c,o.success=!0,o},awa._registerSchemas=function(n){for(var t=0;t<n.length;t++)awa._schemas[n[t].name]=n[t]},awa.console=window.console||{},awa.console.fallback=awa.console.log||function(){},l=["log","info","warn","error","trace"],o=0;o<l.length;o++)a=l[o],awa.console[a]||(awa.console[a]=awa.console.fallback);awa.extendCoreData=function(i){t.removeInvalidElements(i);n.coreData=t.extend(!0,n.coreData,i)}}();awa._registerSchemas([{name:"Ms.Cll.Javascript.CorsDisallowed","Ms.Cll.Javascript.CorsDisallowed":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"}]}}},{name:"Ms.Cll.Javascript.EventTooLong","Ms.Cll.Javascript.EventTooLong":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"},{req:!0,name:"payloadLength",type:"int32"}]}}},{name:"Ms.Cll.Javascript.Error","Ms.Telemetry.Error":{part:"B",def:{fields:[{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}},"Ms.Cll.Javascript.Error":{part:"C",def:{fields:[{req:!0,name:"code",type:"int32"},{req:!0,name:"message",type:"string"}]}}},{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"B",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"serverImpressionGuid",type:"string"},{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"resHeight",type:"int32"},{name:"resWidth",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"cookieEnabled",type:"bool"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.ContentUpdate","Ms.Content.ContentUpdate":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"pageTags",type:"string"},{name:"pageHeight",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"vScrollOffset",type:"int32"},{name:"hScrollOffset",type:"int32"},{name:"contentVer",type:"string"},{req:!0,name:"content",type:"string"}]}},"Ms.Webi.ContentUpdate":{part:"C",def:{fields:[{name:"pageLoadTime",type:"int32"},{name:"title",type:"string"},{name:"isJs",type:"bool"},{name:"cookieEnabled",type:"bool"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"isDomComplete",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"market",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"contentVer",type:"string"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"timeToAction",type:"int32"},{name:"cookieEnabled",type:"bool"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"referrerUri",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}}]);awa.ct=function(){function ct(t){var h,u,o;awa.isAvailable&&(n=t,r=n.autoCapture,i=n.useShortNameForContentBlob===!0?nt.shortNames:nt.longNames,r.pageView&&(n.isLoggedIn===!0&&n.shareAuthStatus===!0?s(function(){awa.ct.capturePageView({isAuto:!0})}):it({isAuto:!0})),r.click&&(window.addEventListener?(h=navigator.appVersion.indexOf("MSIE")!=-1?"click":"mousedown",window.addEventListener(h,f,!1),window.addEventListener("keyup",f,!1)):document.attachEvent&&(document.attachEvent("onclick",f),document.attachEvent("keyup",f))),r.jsErrors&&yi.init(),r.scroll&&(u=tt(null,function(){e({isAuto:!0,actionType:awa.actionType.SCROLL})},n.debounceMs.scroll),window.addEventListener?window.addEventListener("scroll",u):window.attachEvent&&window.attachEvent("onscroll",u)),r.resize&&(o=tt(function(){e({isAuto:!0,actionType:awa.actionType.RESIZE})},null,n.debounceMs.resize),window.addEventListener?window.addEventListener("resize",o):window.attachEvent&&window.attachEvent("onresize",o)),s(awa.ct.domReadyTasksWrapper))}function s(n){/in/.test(document.readyState)?setTimeout("awa.ct.onDomReadyDo("+n+")",9):n.call()}function lt(){n.syncMuid&&vt();r.onLoad&&(document.readyState==="complete"?c():window.addEventListener?window.addEventListener("load",c):window.attachEvent&&window.attachEvent("onload",c))}function at(){awa.ct.domReadyTasks()}function h(){if(n.callback&&typeof n.callback.pageName=="function")return n.callback.pageName();if(n.coreData.pageName)return n.coreData.pageName;var i=window.location.pathname,t=i.split("/");return t.length>2&&t[2]!==""?t[2]:"Home"}function vt(){var r=t.getMuidHost(n.muidDomain||"microsoft.com"),u,i;r?(u=(window.location.protocol||"http:")+"//"+r+"/c.gif?DI=4050&did=1&t=",i=document.createElement("IMG"),i.style.display="none",i.src=u,i.hidden="",i["aria-hidden"]="true",i.role="presentation"):awa.logger.logWarning("Unable to get a muid host for the configured muidDomain '"+n.muidDomain+"'.  Unable to sync muid")}function yt(n){return"which"in n?n.which==3:"button"in n?n.button==2:void 0}function pt(n){return"which"in n?n.which==1:"button"in n?n.button==1:void 0}function wt(n){if("keyCode"in n)return n.keyCode==13}function bt(n){if("keyCode"in n)return n.keyCode==32}function f(n){var s={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},r=n||window.event,i=r.srcElement||r.target,u={isAuto:!0},f,e;if(yt(r))u.behavior=awa.behavior.CONTEXTMENU,u.actionType=o.CLICKRIGHT;else if(pt(r))u.actionType=o.CLICKLEFT;else if(wt(r))u.actionType=o.KEYBOARDENTER;else if(bt(r))u.actionType=o.KEYBOARDSPACE;else return;while(i&&i.tagName)if(s[i.tagName.toUpperCase()]){f=i.tagName.toUpperCase()=="INPUT"?ht[i.type.toUpperCase()]:!0;f&&(e=t.findClosestByAttribute(i,pi),t.isValueAssigned(e)||l(i,u));break}else{i=i.parentElement||i.parentNode;continue}}function tt(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;t&&t.apply(u,f)},o=!r;clearTimeout(r);r=setTimeout(e,i);o&&n&&n.apply(u,f)}}function it(i){var u={},f=awa.utils.extend(!0,n.coreData.pageTags),s;f.metaTags=y(u);v(f);typeof n.callback.pageViewPageTags=="function"&&(f=t.extend(!0,f,n.callback.pageViewPageTags()));var l=si(),e={name:"Ms.Webi.PageView",data:{"Ms.Content.PageView":{ver:b,impressionGuid:d.getPageViewImpressionGuid(),pageName:h(),uri:w(),referrerUri:n.coreData.referrerUri,resHeight:l.h,resWidth:l.w,market:u.market,pageType:u.pageType,pageTags:f,product:u.product,behavior:u.behavior?u.behavior:awa.behavior.UNDEFINED},"Ms.Webi.PageView":{cookieEnabled:p(),cookies:ut(),isJs:!0,title:t.getTitle(),isLoggedIn:n.isLoggedIn,isManual:!0,serverImpressionGuid:u.serverImpressionGuid}},isSensitive:u.isSensitive,env:u.env},o=e.data["Ms.Content.PageView"],c=e.data["Ms.Webi.PageView"];r.addins&&(s=oi(),c.flashInstalled=s.installed||!1,c.flashVersion=s.version||"");i&&(a(e,o,c,i),i.pageTags&&(o.pageTags=t.extend(!0,f,i.pageTags)));o.pageTags=t.stringifyField("pageTags",o.pageTags);g.SendOrScheduleEvent(e,!0)}function c(){e({isAuto:!0,isDomComplete:!0})}function e(i){var f={},u=awa.utils.extend(!0,n.coreData.pageTags),s;u.metaTags=y(f);v(u);i&&i.isDomComplete&&r.perf===!0&&window.performance&&(window.performance.timing&&(u.timing=t.stringifyField("timing",window.performance.timing)),r.assets===!0&&(s=t.getPerformanceData(),s&&(u.AssetPerformance=t.stringifyField("AssetPerformance",s))));typeof n.callback.contentUpdatePageTags=="function"&&(u=t.extend(!0,u,n.callback.contentUpdatePageTags()));var c=hi(),l=ci(),k=ni(c),e={name:"Ms.Webi.ContentUpdate",data:{"Ms.Content.ContentUpdate":{ver:b,impressionGuid:d.getImpressionGuid(),pageName:h(),uri:w(),pageTags:u,pageHeight:document.body.scrollHeight,vpHeight:c.h,vpWidth:c.w,market:f.market,behavior:f.behavior?f.behavior:awa.behavior.UNDEFINED,vScrollOffset:l.v,hScrollOffset:l.h,contentVer:st,content:ti(k)},"Ms.Webi.ContentUpdate":{title:t.getTitle(),cookieEnabled:p(),isJs:!0,isManual:!0,isDomComplete:!1,isLoggedIn:n.isLoggedIn,serverImpressionGuid:f.serverImpressionGuid}},isSensitive:f.isSensitive,env:f.env},o=e.data["Ms.Content.ContentUpdate"],nt=e.data["Ms.Webi.ContentUpdate"];i&&(a(e,o,nt,i),i.pageTags&&(o.pageTags=t.extend(!0,u,i.pageTags)));o.pageTags=t.stringifyField("pageTags",o.pageTags);g.SendOrScheduleEvent(e,!1)}function kt(n){l(null,n)}function dt(n,t){l(n,t)}function l(i,r){var u={},e=awa.utils.extend(!0,n.coreData.pageTags),o={};i=t.returnDomObjectIfjQuery(i);i&&(u.targetUri=fi(i),o=rt(i),o=t.extend(o,ei(i)),o.bhvr&&ot(u,t.extractFieldFromObject(o,"bhvr")));e.metaTags=y(u);v(e);typeof n.callback.pageActionPageTags=="function"&&(e=t.extend(!0,e,n.callback.pageActionPageTags(i)));var c=n.callback.pageActionContentTags,s={name:"Ms.Webi.PageAction",data:{"Ms.Content.PageAction":{ver:b,impressionGuid:d.getImpressionGuid(),pageName:h(),uri:w(),destUri:u.targetUri,market:u.market,pageType:u.pageType,pageTags:e,product:u.product,actionType:u.actionType,behavior:u.behavior,contentVer:st,content:awa.utils.extend(o,typeof c=="function"?c(i):{})},"Ms.Webi.PageAction":{timeToAction:gt(),cookies:ut(),cookieEnabled:p(),isJs:!0,title:t.getTitle(),referrerUri:n.referrerUri,isLoggedIn:n.isLoggedIn,isManual:!0,serverImpressionGuid:u.serverImpressionGuid}},isSensitive:u.isSensitive,env:u.env},f=s.data["Ms.Content.PageAction"],l=s.data["Ms.Webi.PageAction"];r&&(a(s,f,l,r),r.contentTags&&(f.content=t.extend(!0,f.content,r.contentTags)),r.pageTags&&(f.pageTags=t.extend(!0,e,r.pageTags)),r.referrerUri&&(l.referrerUri=t.extractFieldFromObject(f,"referrerUri")));f.pageTags=t.stringifyField("pageTags",f.pageTags);f.content=t.bracketIt(JSON.stringify(f.content));g.SendOrScheduleEvent(s,!0)}function a(n,i,r,u){u.appId&&(n.appId=u.appId);u.behavior&&ot(i,u.behavior);u.uri&&(i.uri=u.uri);u.referrerUri&&(i.referrerUri=u.referrerUri);u.pageName&&(i.pageName=u.pageName);u.actionType&&(i.actionType=u.actionType);u.pageHeight&&(i.pageHeight=u.pageHeight);u.content&&(i.content=u.content);u.targetUri&&(i.destUri=u.targetUri);u.vScrollOffset&&(i.vScrollOffset=u.vScrollOffset);u.hScrollOffset&&(i.hScrollOffset=u.hScrollOffset);r.isManual=u.isAuto!==!0?!0:undefined;u.isDomComplete&&(r.isDomComplete=u.isDomComplete,r.pageLoadTime=t.getPageLoadTime());u.pageLoadTime&&(r.pageLoadTime=u.pageLoadTime)}function gt(){if(window.performance&&window.performance.timing){var n=window.performance.timing.domComplete;if(n!==0)return(new Date).getTime()-n}return-1}function ni(n){return{top:0,bottom:n.h,left:0,right:n.w}}function ti(r){var u=[],f=document.querySelectorAll(t.bracketIt(i.areaName)+","+t.bracketIt(i.slotNumber)+","+t.bracketIt(n.biBlobAttributeTag));return ii(f,u,r),JSON.stringify(u)}function ii(n,i,r){var u,f;if(n)for(u=0;u<n.length;u++)t.isElementTrulyVisible(n[u],r)&&(f=rt(n[u]),f&&i.push(f))}function rt(r){var u,h,c,e,l,o,s,f,a;if(!r)return"";if(u={},h=awa.utils.findClosestByAttribute(r,n.biBlobAttributeTag),h&&(c=h.getAttribute(n.biBlobAttributeTag)),c)u=JSON.parse(c);else for(e=t.findClosestByAttribute(r,t.bracketIt(i.id)),e=t.returnDomObjectIfjQuery(r),l=t.findClosestByAttribute(r,i.areaName),o=awa.utils.extend({},ui(l)),u={id:e.getAttribute(i.id)||r.id||"",aN:o.areaName,sN:e.getAttribute(i.slotNumber),cN:e.getAttribute(i.contentName)||ri(r)||e.getAttribute("alt")||"",cS:e.getAttribute(i.contentSource)||o.contentSource,tN:o.templateName,pid:e.getAttribute(i.productId),cT:e.getAttribute(i.contentType)||o.type},u.id&&u.aN&&u.sN&&u.cN||awa.logger.logWarning("Invalid content blob.  Missing required attributes (id, aN/area, sN/slot), cN/contentName.  Content information will still be collected!"),i.isShortNames||(u={contentId:u.id,areaName:u.aN,slotNumber:u.sN,contentName:u.cN,contentSource:u.cS,templateName:u.tN,productId:u.pid,contentType:u.cT}),s=0;s<e.attributes.length;s++)(f=e.attributes[s],f.name!=i.id&&f.name!=i.areaName&&f.name!=i.slotNumber&&f.name!=i.contentName&&f.name!=i.contentSource&&f.name!=i.templateName&&f.name!=i.productId&&f.name!=i.contentType&&f.name.indexOf("data-bi-")!=-1)&&(a=f.name.replace("data-bi-",""),u[a]=f.value);return awa.utils.removeInvalidElements(u),u}function ri(t){if(n.useDefaultContentName===!1||et(t)||!t.tagName)return"";var i;switch(t.tagName){case"A":i=document.all?t.innerText||t.innerHTML:t.text||t.innerHTML;case"IMG":case"AREA":i=t.alt;default:i=t.value||t.name||t.alt||t.innerText||t.id}return i.substring(0,vi)}function ui(n){return n=t.returnDomObjectIfjQuery(n),n?{areaName:n.getAttribute(i.areaName),templateName:n.getAttribute(i.templateName),contentSource:n.getAttribute(i.contentSource),product:n.getAttribute(i.productId),type:n.getAttribute(i.contentType)}:void 0}function ut(){var e="",o={},t=[],u=n.cookiesToCollect,i,r,f;if(n.shareAuthStatus===!1)t=u;else for(i=0;i<u.length;i++)u[i]!="ANON"&&t.push(u[i]);try{try{window.varCustomerCookies&&window.varCustomerCookies.length>0&&(t=t.concat(window.varCustomerCookies))}catch(s){}for(r in t)o.hasOwnProperty(t[r])||(o[t[r]]="",f=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t[r]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")),f!==""&&(e+=t[r]+"="+f+";"))}catch(s){}return e}function fi(n){var t="",i,r;switch(n.tagName){case"A":case"AREA":t=n.href||"";break;case"IMG":t=li(r);break;case"INPUT":i=n.type;r=window.event;i&&ht[i.toUpperCase()]&&(t=n.form?n.form.action||window.location.pathname:window.location.pathname)}return t}function ei(n){for(var r={},t,i;n;)if(!et(n)){for(t in n.attributes)t&&n.attributes[t]&&(i=n.attributes[t].name,i&&i.toLowerCase().indexOf("ms.")===0&&(r[i]=n.attributes[t].value));n=n.parentElement||n.parentNode}return r}function oi(){var n={},i,r,t,u;if(navigator.plugins["Shockwave Flash"])n.installed=!0,i=navigator.plugins["Shockwave Flash"],n.version=i.description.split(" ")[2];else if(navigator.userAgent.indexOf("MSIE")!=-1)for(r=(new Date).getFullYear()-1992,t=r;t>0;t--)try{u=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t);n.installed=!0;n.version=t+".0";break}catch(f){}return n}function v(n){if(!n.enabledFeatures){var t=k.getCookie("Features");t&&(n.enabledFeatures=t)}}function y(i){var r={},f={};return r=ft("awa-",!0),i.env=u(r,n.coreData,"env"),i.pageType=u(r,n.coreData,"pageType"),i.product=u(r,n.coreData,"product"),i.market=u(r,n.coreData,"market"),i.serverImpressionGuid=u(r,n.coreData,"serverImpressionGuid"),i.isSensitive=u(r,n.coreData,"isSensitive"),f=ft("ms.",!1),t.extend(!0,r,f)}function u(n,i,r){var u=t.extractFieldFromObject(n,r);return i[r]?i[r]:u}function ft(n,t){for(var u={},i,f,e,o=document.querySelectorAll("meta"),r=0;r<o.length;r++)i=o[r],i.name&&(f=i.name.toLowerCase(),f.indexOf(n)===0&&(e=t?i.name.replace(n,""):i.name,u[e]=i.content));return u}function si(){var n={h:0,w:0};return window.screen&&(n.h=screen.height,n.w=screen.width),n}function hi(){var n={h:0,w:0};return window.screen&&(n.h=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight,n.w=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth),n}function ci(){return{h:parseInt(document.body.scrollLeft||document.documentElement.scrollLeft||window.pageXOffset||0,10),v:parseInt(document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0,10)}}function p(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var n="MC0",t=k.getCookie(n);return t||(document.cookie=n+"=1",t=k.getCookie(n)),t?!0:!1}function li(n){var r=n,i;if(r&&(i=t.findClosestAnchor(r),i.length===1)){if(i[0].href)return i[0].href;if(i[0].src)return i[0].src}return""}function et(n){if(!n||!n.attributes)return!1;try{var i=n.getAttribute("data-dc");return t.isValueAssigned(i)?i.toLowerCase()=="pii"?1:0:0}catch(r){return 0}}function ai(n){for(var t=0;t<awa.behaviorKeys.length;t++)if(awa.behavior[awa.behaviorKeys[t]]==n)return!0;return awa.logger.logWarning("Unsupported behavior: "+n+"."),!1}function ot(n,i){if(t.isOfCorrectType("uint16",Number(i)))ai(i)&&(n.behavior=Number(i));else if(t.isOfCorrectType("string",i)){var r=awa.behavior[i.toUpperCase()];t.isOfCorrectType("uint16",r)&&(n.behavior=r)}}function w(){return n.coreData.requestUri===""?window.location.href:n.coreData.requestUri}var b="1.0",st="2.0",vi=200,n={},r={},k=awa.cookie,yi=awa.errorHandler,d=awa.ids,g=awa.vortexEvents,t=awa.utils,o=awa.actionType,pi="data-bi-dnt",nt={longNames:{isShortNames:!1,id:"data-bi-id",areaName:"data-bi-area",slotNumber:"data-bi-slot",contentName:"data-bi-name",contentSource:"data-bi-source",templateName:"data-bi-view",productId:"data-bi-product",contentType:"data-bi-type"},shortNames:{isShortNames:!0,id:"data-bi-id",areaName:"data-bi-aN",slotNumber:"data-bi-sN",contentName:"data-bi-cN",contentSource:"data-bi-cS",templateName:"data-bi-tN",productId:"data-bi-pid",contentType:"data-bi-cT"}},i=nt.longNames,ht={BUTTON:!0,CHECKBOX:!0,RADIO:!0,RESET:!0,SUBMIT:!0};return{initialize:ct,capturePageView:it,captureContentUpdate:e,capturePageAction:dt,captureContentPageAction:kt,domReadyTasksWrapper:at,onDomReadyDo:s,domReadyTasks:lt}}();awa.service=function(){function f(n){typeof n=="function"?t=n:typeof n=="string"&&(t=function(){return n})}var i=awa.timespanHandler,r=!0,u=!1,t=null,n=function(n){var e,s,h;if(typeof jQuery=="function"){r&&($.support.cors=!0);var c=n.additionalHeaders||{},l=n.body,y=l?JSON.stringify(l):n.data||undefined,p=n.maxRetry||0,o=0,w=$.noop,a=n.operationName||n.url,b=n.errorFormatter||function(n){return n},v=awa.ids,f={url:n.url,type:n.method,data:y,crossDomain:!0,headers:{},success:n.success,timeout:n.timeout,error:n.error,jsonp:n.jsonp,jsonpCallback:n.jsonpCallback,cache:n.cache,beforeSend:function(t){if(w(t),n.contractVersion&&t.setRequestHeader("MS-Contract-Version",n.contractVersion),(!awa.utils.isValueAssigned(n.addCvToRequestHeader)&&u||n.addCvToRequestHeader)&&awa.cv.isValid(e)&&t.setRequestHeader("MS-CV",e),c)for(var i in c)t.setRequestHeader(i,c[i])},defaultError:n.defaultError};return n.dataType&&(f.dataType=n.dataType),n.noCacheBusting||(f.cache=!1),n.contentType&&(f.contentType=n.contentType),n.accept&&(f.headers.Accept=n.accept),n.accepts&&(f.accepts=n.accepts),n.async&&(f.async=n.async),n.xhrFields&&(f.xhrFields=n.xhrFields),n.complete&&(f.complete=n.complete),n.contents&&(f.contents=n.contents),n.context&&(f.context=n.context),n.dataFilter&&(f.dataFilter=n.dataFilter),n.global&&(f.global=n.global),n.ifModified&&(f.ifModified=n.ifModified),n.isLocal&&(f.isLocal=n.isLocal),n.mimeType&&(f.mimeType=n.mimeType),n.password&&(f.password=n.password),n.processData&&(f.processData=n.processData),n.scriptCharset&&(f.scriptCharset=n.scriptCharset),n.statusCode&&(f.statusCode=n.statusCode),n.traditional&&(f.traditional=n.traditional),n.type&&(f.type=n.type),n.username&&(f.username=n.username),n.xhr&&(f.xhr=n.xhr),e=awa.cv.isValid(n.cV)?n.cV:awa.cv.increment(),s=function(i,r,u){var s=i.getResponseHeader("Content-Length"),h={name:"Ms.Webi.OutgoingRequest",cV:e,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:n.currentOperationName||window.location.href,targetUri:t?t(f.url):f.url,latencyMs:u,serviceErrorCode:!r&&i.responseJSON&&i.responseJSON.code&&!isNaN(i.responseJSON.code)?i.responseJSON.code:-1,succeeded:r,requestMethod:f.type,responseContentType:f.dataType,protocolStatusCode:i.status.toString(),dependencyOperationName:a,dependencyOperationVersion:n.version&&n.version.toString(),dependencyName:n.serviceName,dependencyType:"WebService",responseSizeBytes:s&&parseInt(s,10)},"Ms.Webi.OutgoingRequest":{customSessionGuid:v.getSessionId(),impressionGuid:v.getImpressionGuid(),message:r?undefined:awa.utils.stringifyField("errorMessage",i.errorThrown),retryCount:o,customData:n.customDataCallBack&&typeof n.customDataCallBack=="function"?awa.utils.stringifyField("customData",n.customDataCallBack(i)):undefined}}};n.QosCallback&&typeof n.QosCallback=="function"&&n.QosCallback(i,h);awa.vortexEvents.SendOrScheduleEvent(h)},h=function(){var t=a+"_Retry_"+o;return i.recordTimeSpan(t),$.ajax(f).then(function(n,r,u){var f=i.recordTimeSpan(t,!0);return s(u,!0,f),u},function(r,u){var c=i.recordTimeSpan(t,!0),f;return s(r,!1,c),f=$.Deferred(),p>o&&(r.status===0||r.status>=500&&r.status<600)?(o++,e=awa.cv.isValid(n.cV)?awa.cv.incrementExternal(e):awa.cv.increment(),setTimeout(function(){h().done(f.resolve).fail(f.reject)},50)):f.reject(r,u),f.promise()})},h().then(function(n,t,i){return i},function(t){return b(t,n)})}awa.logger.logError("jQuery is not defined, cannot use service module")};return{post:function(t){return n(awa.utils.extend({},t,{method:"POST"}))},get:function(t){return n(awa.utils.extend({maxRetry:1},t,{method:"GET"}))},put:function(t){return n(awa.utils.extend({},t,{method:"PUT"}))},del:function(t){return n(awa.utils.extend({},t,{method:"DELETE"}))},patch:function(t){return n(awa.utils.extend({},t,{method:"PATCH"}))},doNotChangeSupportCors:function(){r=!1},alwaysAddCvToRequestHeader:function(){u=!0},setTargetUriOverride:f}}()